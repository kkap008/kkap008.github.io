<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script defer src="tab_menu.js"></script>
    <style>
      div {
        margin: 1rem 0;
      }
    </style>
    <style>
      .hidden {
        display: inline-block;
        white-space: nowrap;
        overflow: hidden;
        width: 1px;
        height: 1px;
        position: absolute;
        margin: -1px;
        clip: rect(0 0 0 0);
        clip-path: polygon(0 0, 0 0, 0 0);
      }
      .template {
        cursor: pointer;
      }
    </style>
    <title>JS - 함수</title>
  </head>
  <body>
    <h1>이름과 주소를 입력받아 출력하는 함수 작성</h1>
    <div data-prompt>
      <span data-prompt="print"></span>
      <button type="button" data-prompt="input">입력받기</button>
    </div>
    <hr />
    <h1>BMI 계산기</h1>
    <div data-bmi>
      <p data-bmi="kg">
        <input
          data-bmi="kg-input"
          id="kg"
          type="number"
          placeholder="300kg 이하로 작성"
        />
        <label for="kg">kg</label>
      </p>
      <p data-bmi="cm">
        <input
          data-bmi="cm-input"
          id="cm"
          type="number"
          placeholder="3m 이하로 작성"
        />
        <label for="cm">cm</label>
      </p>
      <button type="button" data-bmi="btn">bmi 계산</button>
      <span data-bmi="result"></span>
    </div>
    <hr />
    <tab-menu data-tab-menu></tab-menu>

    <script>
      "use strict";

      (function () {
        const $bmi_kg = document.querySelector("[data-bmi='kg-input']");
        const $bmi_cm = document.querySelector("[data-bmi='cm-input']");
        const $bmi_btn = document.querySelector("[data-bmi='btn']");

        $bmi_kg.addEventListener("input", function () {
          if (this.__proto__.debounce) {
            clearTimeout(this.debounce);
          }

          this.__proto__.debounce = setTimeout(
            function () {
              if (this.value > 200) {
                alert("300kg 이하로 작성해주세요");
                this.value = null;
                delete this.__proto__.debounce;
                return;
              }
            }.bind(this),
            200
          );
        });

        $bmi_cm.addEventListener("input", function () {
          if (this.__proto__.debounce) {
            clearTimeout(this.debounce);
          }

          this.__proto__.debounce = setTimeout(
            function () {
              if (this.value > 300) {
                alert("3m 이하로 작성해주세요");
                this.value = null;
                delete this.__proto__.debounce;
                return;
              }
            }.bind(this),
            200
          );
        });

        $bmi_btn.addEventListener("click", () => {
          const $bmi_kg = document.querySelector("[data-bmi='kg-input']");
          const $bmi_cm = document.querySelector("[data-bmi='cm-input']");
          const kg = $bmi_kg.value || undefined;
          const cm = $bmi_cm.value / 100 || undefined;

          if (!cm && !kg) {
            alert("kg 또는 cm 값을 입력해주세요");
            return;
          }

          const $result = document.querySelector("[data-bmi='result']");
          const bmi = (kg / cm ** 2).toFixed(2);

          switch (true) {
            case bmi < 20:
              $result.textContent = `신체질량지수(BMI)는 ${bmi}로 '저체중'입니다`;
              break;
            case bmi <= 24:
              $result.textContent = `신체질량지수(BMI)는 ${bmi}로 '정상'입니다`;
              break;
            case bmi <= 29:
              $result.textContent = `신체질량지수(BMI)는 ${bmi}로 '과체중'입니다`;
              break;
            default:
              $result.textContent = `신체질량지수(BMI)는 ${bmi}로 '비만'입니다`;
              break;
          }

          $bmi_cm.value = $bmi_kg.value = null;
        });
      })();

      (function () {
        function promptEvent() {
          const local = prompt("사는 지역은?") || undefined;
          const user = prompt("이름은?") || undefined;
          const $print = document.querySelector("[data-prompt='print']");

          switch (local && user) {
            case undefined:
            case false:
              if (!local && !user) {
                $print.textContent = "이름과 주소를 입력해주세요";
              } else if (!local) {
                $print.textContent = "주소를 입력해주세요";
              } else {
                $print.textContent = "이름을 입력해주세요";
              }
              break;
            default:
              if (user.match(/[\d]+/)) {
                $print.textContent = "이름은 영문,한글로 입력해주세요";
                return;
              } else {
                $print.textContent = `${user
                  .match(/[a-zA-Z\s가-힣ㄱ-ㅎ]/g)
                  .join()}가 사는 지역은 ${local}입니다`;
              }

              break;
          }
        }

        const $input = document.querySelector("[data-prompt='input']");
        $input.addEventListener("click", promptEvent);
      })();
    </script>
  </body>
</html>
